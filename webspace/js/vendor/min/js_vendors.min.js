/**
 * Created by n.vanderburg on 08/08/2017.
 */
function onYouTubeIframeAPIReady(){console.log("onYouTubeIframeAPIReady");for(var i in videos)player=new YT.Player("video-"+videos[i],{videoId:videos[i],width:"100%",height:videoResize(),playerVars:{modesbranding:1,rel:0,showinfo:0},events:{onStateChange:"onPlayerStateChange",onReady:"onPlayerReady"}}),players.push({id:videos[i],player:player})}function videoResize(){return console.log("videoResize"),$(".video-txt").height()/2}function onPlayerReady(event){console.log("onPlayerReady")}function fullScreen(){console.log("fullScreen");var e=document.getElementById("video-wrapper");e.requestFullscreen?(e.requestFullscreen(),console.log("fullScreen")):e.webkitRequestFullscreen?(e.webkitRequestFullscreen(),console.log("fullScreen")):e.mozRequestFullScreen?(e.mozRequestFullScreen(),console.log("fullScreen")):e.msRequestFullscreen&&(e.msRequestFullscreen(),console.log("fullScreen"))}function onPlayerStateChange(event){console.log("onPlayerStateChange",event);var video_data=event.target.getVideoData(),video_duration=event.target.getDuration(),video_id=video_data.video_id,titulo=video_data.title;if(videoPlaying){var videoPlayingData=videoPlaying.target.getVideoData();videoPlayingData.video_id!=video_id&&(videoPlaying.target.stopVideo(),videoPlaying=!1,videoCheckpoints[25]=!1,videoCheckpoints[50]=!1,videoCheckpoints[75]=!1,videoPlayingLastActividadId=!1,clearInterval(videoIntervalo))}switch(event.data){case YT.PlayerState.PLAYING:videoPlaying=event,console.log("trackea el video",videoPlaying),videoPlaying.target.getCurrentTime()<=1&&trackEvent({category:"video",action:"play",label:titulo}),videoIntervalo=setInterval(function(){var porcentaje=parseInt(videoPlaying.target.getCurrentTime()/video_duration*100,10);porcentaje>25&&!videoCheckpoints[25]?(videoCheckpoints[25]=!0,trackEvent({category:"video",action:"25",label:titulo})):porcentaje>50&&!videoCheckpoints[50]?(videoCheckpoints[50]=!0,trackEvent({category:"video",action:"50",label:titulo})):porcentaje>75&&!videoCheckpoints[75]&&(videoCheckpoints[75]=!0,trackEvent({category:"video",action:"75",label:titulo}))},1e3);break;case YT.PlayerState.PAUSED:console.log("video paused"),clearInterval(videoIntervalo),videoPlaying=!1,ultimaActividad=Date.now();break;case YT.PlayerState.ENDED:console.log("video ended"),clearInterval(videoIntervalo),videoPlaying=!1,videoCheckpoints[25]=!1,videoCheckpoints[50]=!1,videoCheckpoints[75]=!1,trackEvent({category:"video",action:"100",label:titulo}),ultimaActividad=Date.now()}}function pausePlayers(playerId){console.log("pausePlayers");for(var i in players){var player=players[i].player;if("undefined"!=typeof playerId){if(playerId==players[i].id)return player.pauseVideo(),!0}else player.pauseVideo()}}var videos=[],players=[],player=null,videoPlaying=!1,videoPlayingLastActividadId=!1,videoIntervalo=!1,videoCheckpoints=new Array;videoCheckpoints[25]=!1,videoCheckpoints[50]=!1,videoCheckpoints[75]=!1;var ultimaActividad=!1;$(document).ready(function(){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),$('[id*="video-"]').each(function(){var videoId=$(this).attr("id"),videoIdSplit=videoId.split("-");videos.push(videoIdSplit[1])}),$(window).resize(function(){$(".video iframe").attr("height",$(".video-txt").height()/2)}),$(".slick-slider").on("beforeChange",function(){$(this).find(".video-container").each(function(i,el){if($(el).find("iframe").length>0){var playerId=$(el).data("videoId");pausePlayers(playerId)}})})});